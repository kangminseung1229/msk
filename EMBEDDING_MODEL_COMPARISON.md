# Google 임베딩 모델 비교표

## 모델별 상세 비교

| 항목 | text-embedding-004<br/>(현재 사용 중) | text-embedding-005<br/>(권장 옵션 1) | gemini-embedding-001<br/>(권장 옵션 2) |
|------|--------------------------------------|--------------------------------------|------------------------------------------|
| **상태** | ⚠️ Deprecated<br/>(2026-01-14 종료 예정) | ✅ Active | ✅ Active (최신) |
| **출시일** | 구 모델 | 2024년 | 2025년 7월 |
| **벡터 차원** | 768 (고정) | 768 (고정) | 3072 (기본)<br/>1536, 768 (조정 가능) |
| **최대 입력 토큰** | 2,048 | 2,048 | 2,048 |
| **언어 지원** | 영어 중심 | 영어 + 코드 | 100+ 언어<br/>(영어/다국어/코드 통합) |
| **가격** | $0.10 / 100만 토큰 | $0.10 / 100만 토큰 | $0.15 / 100만 토큰 |
| **성능** | 기준선 | text-embedding-004 대비 향상 | 최고 성능<br/>(MTEB 벤치마크 우수) |
| **특화 분야** | 범용 | 영어/코드 특화 | 통합 모델<br/>(검색/분류/재순위화) |
| **MTEB 성능** | - | - | Multilingual: 68.32<br/>Pair Classification: 85.13<br/>Retrieval: 67.71<br/>Reranking: 65.58 |

## 현재 프로젝트와의 호환성

| 항목 | text-embedding-004 | text-embedding-005 | gemini-embedding-001 |
|------|-------------------|-------------------|---------------------|
| **pgvector dimensions=768** | ✅ 호환 | ✅ 호환 | ⚠️ 768로 설정 시 호환<br/>(기본 3072와 불일치) |
| **기존 벡터 DB** | ✅ 사용 중 | ✅ 재생성 필요<br/>(모델 변경 시) | ⚠️ 재생성 필요<br/>(차원 조정 시) |
| **마이그레이션 난이도** | - | 🟢 쉬움<br/>(차원 동일) | 🟡 보통<br/>(차원 조정 필요) |
| **코드 변경** | - | 최소 변경<br/>(모델명만) | 모델명 + 차원 설정 |

## 권장사항

### 🟢 옵션 1: text-embedding-005 (단기 권장)
**장점:**
- ✅ 현재 768 차원과 완벽 호환
- ✅ 기존 벡터 DB 재생성만 필요 (차원 변경 없음)
- ✅ text-embedding-004 대비 성능 향상
- ✅ 마이그레이션 부담 최소
- ✅ 가격 동일 ($0.10 / 100만 토큰)

**단점:**
- ⚠️ 다국어 지원 제한적
- ⚠️ 향후 gemini-embedding-001로 재마이그레이션 필요할 수 있음

**적용 시나리오:**
- 현재 시스템을 빠르게 업그레이드하고 싶을 때
- 영어 중심 서비스
- 최소한의 변경으로 성능 개선 원할 때

---

### 🟡 옵션 2: gemini-embedding-001 (장기 권장)
**장점:**
- ✅ 최신 모델, 최고 성능
- ✅ 100+ 언어 지원 (다국어 서비스에 적합)
- ✅ 차원 조정 가능 (768로 설정 시 기존과 호환)
- ✅ Google의 장기 지원 모델

**단점:**
- ⚠️ 가격 50% 증가 ($0.15 / 100만 토큰)
- ⚠️ 기존 벡터 DB 재생성 필요
- ⚠️ 차원 설정 명시 필요 (기본 3072)

**적용 시나리오:**
- 다국어 서비스 제공
- 최고 성능이 필요한 경우
- 장기적인 관점에서 최신 기술 적용 원할 때

---

## 마이그레이션 체크리스트

### text-embedding-005로 변경 시
- [ ] `application.properties`에서 모델명 변경
- [ ] 기존 벡터 DB 데이터 삭제 또는 백업
- [ ] `CounselEmbeddingService.embedAllConsultations()` 재실행
- [ ] `LawArticleEmbeddingService.embedAllLatestLawArticles()` 재실행
- [ ] 검색 성능 테스트

### gemini-embedding-001로 변경 시
- [ ] `application.properties`에서 모델명 변경
- [ ] `outputDimensionality=768` 파라미터 추가 (차원 조정)
- [ ] 기존 벡터 DB 데이터 삭제 또는 백업
- [ ] `CounselEmbeddingService.embedAllConsultations()` 재실행
- [ ] `LawArticleEmbeddingService.embedAllLatestLawArticles()` 재실행
- [ ] 검색 성능 테스트
- [ ] 비용 모니터링 (가격 50% 증가)

---

## 참고사항

1. **text-embedding-004는 2026년 1월 14일에 deprecated 예정**이므로 반드시 마이그레이션 필요
2. **벡터 차원이 다르면 기존 벡터 DB와 호환되지 않음** - 반드시 재생성 필요
3. **gemini-embedding-001은 Matryoshka Representation Learning 지원** - 768 차원으로 설정해도 성능 손실 최소
4. **가격 차이**: gemini-embedding-001은 50% 더 비쌈 ($0.15 vs $0.10)
